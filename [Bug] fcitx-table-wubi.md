

删除`fcitx=table-wubi`时
```log
2022-04-05 00:31:56 (INFO-3007199 addon.c:151) 加载附加组件配置文件: fcitx-table.conf
2022-04-05 00:31:56 (INFO-3007199 addon.c:151) 加载附加组件配置文件: fcitx-lua.conf
2022-04-05 00:31:56 (INFO-3007199 addon.c:151) 加载附加组件配置文件: fcitx-imselector.conf
2022-04-05 00:31:56 (INFO-3007199 addon.c:151) 加载附加组件配置文件: fcitx-pinyin-enhance.conf
2022-04-05 00:31:56 (INFO-3007199 addon.c:151) 加载附加组件配置文件: fcitx-ipc.conf
2022-04-05 00:31:56 (INFO-3007199 addon.c:151) 加载附加组件配置文件: fcitx-keyboard.conf
2022-04-05 00:31:56 (INFO-3007199 addon.c:151) 加载附加组件配置文件: fcitx-sunpinyin.conf
2022-04-05 00:31:56 (INFO-3007199 addon.c:151) 加载附加组件配置文件: fcitx-spell.conf
2022-04-05 00:31:56 (INFO-3007199 addon.c:151) 加载附加组件配置文件: fcitx-xkbdbus.conf
2022-04-05 00:31:56 (INFO-3007199 addon.c:151) 加载附加组件配置文件: fcitx-ipcportal.conf
2022-04-05 00:31:56 (INFO-3007199 addon.c:151) 加载附加组件配置文件: fcitx-remote-module.conf
2022-04-05 00:31:56 (INFO-3007199 addon.c:151) 加载附加组件配置文件: fcitx-vk.conf
2022-04-05 00:31:56 (INFO-3007199 addon.c:151) 加载附加组件配置文件: fcitx-unicode.conf
2022-04-05 00:31:56 (INFO-3007199 addon.c:151) 加载附加组件配置文件: fcitx-x11.conf
2022-04-05 00:31:56 (INFO-3007199 addon.c:151) 加载附加组件配置文件: fcitx-xkb.conf
2022-04-05 00:31:56 (INFO-3007199 addon.c:151) 加载附加组件配置文件: fcitx-clipboard.conf
2022-04-05 00:31:56 (INFO-3007199 addon.c:151) 加载附加组件配置文件: fcitx-xim.conf
2022-04-05 00:31:56 (INFO-3007199 addon.c:151) 加载附加组件配置文件: fcitx-freedesktop-notify.conf
2022-04-05 00:31:56 (INFO-3007199 addon.c:151) 加载附加组件配置文件: fcitx-fullwidth-char.conf
2022-04-05 00:31:56 (INFO-3007199 addon.c:151) 加载附加组件配置文件: fcitx-chttrans.conf
2022-04-05 00:31:56 (INFO-3007199 addon.c:151) 加载附加组件配置文件: fcitx-implugin.conf
2022-04-05 00:31:56 (INFO-3007199 addon.c:151) 加载附加组件配置文件: fcitx-classic-ui.conf
2022-04-05 00:31:56 (INFO-3007199 addon.c:151) 加载附加组件配置文件: fcitx-notificationitem.conf
2022-04-05 00:31:56 (INFO-3007199 addon.c:151) 加载附加组件配置文件: fcitx-autoeng.conf
2022-04-05 00:31:56 (INFO-3007199 addon.c:151) 加载附加组件配置文件: fcitx-punc.conf
2022-04-05 00:31:56 (INFO-3007199 addon.c:151) 加载附加组件配置文件: fcitx-dbus.conf
2022-04-05 00:31:56 (INFO-3007199 addon.c:151) 加载附加组件配置文件: fcitx-kimpanel-ui.conf
2022-04-05 00:31:56 (INFO-3007199 addon.c:151) 加载附加组件配置文件: fcitx-quickphrase.conf
2022-04-05 00:31:56 (INFO-3007199 addon.c:151) 加载附加组件配置文件: fcitx-pinyin.conf
2022-04-05 00:31:56 (INFO-3006329 ipc.c:668) Receive message ask for quit
2022-04-05 00:31:57 (ERROR-3007199 ime.c:432) fcitx-keyboard-in-kan-kagapa already exists
2022-04-05 00:31:57 (ERROR-3007199 ime.c:432) fcitx-keyboard-in-tel-kagapa already exists
2022-04-05 00:31:57 (ERROR-3007199 ime.c:432) fcitx-keyboard-cm-mmuock already exists
```


重新安装：
```log
2022-04-05 00:32:19 (INFO-3007586 addon.c:151) 加载附加组件配置文件: fcitx-table.conf
2022-04-05 00:32:19 (INFO-3007586 addon.c:151) 加载附加组件配置文件: fcitx-lua.conf
2022-04-05 00:32:19 (INFO-3007586 addon.c:151) 加载附加组件配置文件: fcitx-imselector.conf
2022-04-05 00:32:19 (INFO-3007586 addon.c:151) 加载附加组件配置文件: fcitx-pinyin-enhance.conf
2022-04-05 00:32:19 (INFO-3007586 addon.c:151) 加载附加组件配置文件: fcitx-ipc.conf
2022-04-05 00:32:19 (INFO-3007586 addon.c:151) 加载附加组件配置文件: fcitx-keyboard.conf
2022-04-05 00:32:19 (INFO-3007586 addon.c:151) 加载附加组件配置文件: fcitx-sunpinyin.conf
2022-04-05 00:32:19 (INFO-3007586 addon.c:151) 加载附加组件配置文件: fcitx-spell.conf
2022-04-05 00:32:19 (INFO-3007586 addon.c:151) 加载附加组件配置文件: fcitx-xkbdbus.conf
2022-04-05 00:32:19 (INFO-3007586 addon.c:151) 加载附加组件配置文件: fcitx-ipcportal.conf
2022-04-05 00:32:19 (INFO-3007586 addon.c:151) 加载附加组件配置文件: fcitx-remote-module.conf
2022-04-05 00:32:19 (INFO-3007586 addon.c:151) 加载附加组件配置文件: fcitx-vk.conf
2022-04-05 00:32:19 (INFO-3007586 addon.c:151) 加载附加组件配置文件: fcitx-unicode.conf
2022-04-05 00:32:19 (INFO-3007586 addon.c:151) 加载附加组件配置文件: fcitx-x11.conf
2022-04-05 00:32:19 (INFO-3007586 addon.c:151) 加载附加组件配置文件: fcitx-xkb.conf
2022-04-05 00:32:19 (INFO-3007586 addon.c:151) 加载附加组件配置文件: fcitx-clipboard.conf
2022-04-05 00:32:19 (INFO-3007586 addon.c:151) 加载附加组件配置文件: fcitx-xim.conf
2022-04-05 00:32:19 (INFO-3007586 addon.c:151) 加载附加组件配置文件: fcitx-freedesktop-notify.conf
2022-04-05 00:32:19 (INFO-3007586 addon.c:151) 加载附加组件配置文���������������: fcitx-fullwidth-char.conf
2022-04-05 00:32:19 (INFO-3007586 addon.c:151) 加载附加组件配置文件: fcitx-chttrans.conf
2022-04-05 00:32:19 (INFO-3007586 addon.c:151) 加载附加组件配置文件: fcitx-implugin.conf
2022-04-05 00:32:19 (INFO-3007586 addon.c:151) 加载附加组件配置文件: fcitx-classic-ui.conf
2022-04-05 00:32:19 (INFO-3007586 addon.c:151) 加载附加组件配置文件: fcitx-notificationitem.conf
2022-04-05 00:32:19 (INFO-3007586 addon.c:151) 加载附加组件配置文件: fcitx-autoeng.conf
2022-04-05 00:32:19 (INFO-3007586 addon.c:151) 加载附加组件配置文件: fcitx-punc.conf
2022-04-05 00:32:19 (INFO-3007586 addon.c:151) 加载附加组件配置文件: fcitx-dbus.conf
2022-04-05 00:32:19 (INFO-3007586 addon.c:151) 加载附加组件配置文件: fcitx-kimpanel-ui.conf
2022-04-05 00:32:19 (INFO-3007586 addon.c:151) 加载附加组件配置文件: fcitx-quickphrase.conf
2022-04-05 00:32:19 (INFO-3007586 addon.c:151) 加载附加组件配置文件: fcitx-pinyin.conf
2022-04-05 00:32:19 (INFO-3007199 ipc.c:668) Receive message ask for quit
2022-04-05 00:32:20 (ERROR-3007586 ime.c:432) fcitx-keyboard-in-kan-kagapa already exists
2022-04-05 00:32:20 (ERROR-3007586 ime.c:432) fcitx-keyboard-in-tel-kagapa already exists
2022-04-05 00:32:20 (ERROR-3007586 ime.c:432) fcitx-keyboard-cm-mmuock already exists

(fcitx-config-gtk3:3007633): GLib-GObject-CRITICAL **: 00:32:29.903: g_value_set_boxed: assertion 'G_VALUE_HOLDS_BOXED (value)' failed

(fcitx-config-gtk3:3007633): dbind-WARNING **: 00:32:29.906: Error retrieving accessibility bus address: org.freedesktop.DBus.Error.ServiceUnknown: The name org.a11y.Bus was not provided by any .service files

(fcitx-config-gtk3:3007633): Gtk-WARNING **: 00:32:29.917: Theme parsing error: gtk.css:3611:22: 'none' is not a valid color name

(fcitx-config-gtk3:3007633): Gtk-CRITICAL **: 00:32:29.934: gtk_spin_button_new_with_range: assertion 'min <= max' failed

(fcitx-config-gtk3:3007633): GLib-GObject-CRITICAL **: 00:32:29.934: g_object_set: assertion 'G_IS_OBJECT (object)' failed

(fcitx-config-gtk3:3007633): GLib-GObject-WARNING **: 00:32:29.934: invalid (NULL) pointer instance

(fcitx-config-gtk3:3007633): GLib-GObject-CRITICAL **: 00:32:29.934: g_signal_connect_data: assertion 'G_TYPE_CHECK_INSTANCE (instance)' failed

(fcitx-config-gtk3:3007633): Gtk-CRITICAL **: 00:32:29.940: gtk_spin_button_new_with_range: assertion 'min <= max' failed

(fcitx-config-gtk3:3007633): GLib-GObject-CRITICAL **: 00:32:29.940: g_object_set: assertion 'G_IS_OBJECT (object)' failed

(fcitx-config-gtk3:3007633): GLib-GObject-WARNING **: 00:32:29.940: invalid (NULL) pointer instance

(fcitx-config-gtk3:3007633): GLib-GObject-CRITICAL **: 00:32:29.940: g_signal_connect_data: assertion 'G_TYPE_CHECK_INSTANCE (instance)' failed

(fcitx-config-gtk3:3007633): Gtk-CRITICAL **: 00:32:29.982: gtk_spin_button_new_with_range: assertion 'min <= max' failed

(fcitx-config-gtk3:3007633): GLib-GObject-CRITICAL **: 00:32:29.982: g_object_set: assertion 'G_IS_OBJECT (object)' failed

(fcitx-config-gtk3:3007633): GLib-GObject-WARNING **: 00:32:29.982: invalid (NULL) pointer instance

(fcitx-config-gtk3:3007633): GLib-GObject-CRITICAL **: 00:32:29.982: g_signal_connect_data: assertion 'G_TYPE_CHECK_INSTANCE (instance)' failed

(fcitx-config-gtk3:3007633): Gtk-CRITICAL **: 00:32:29.982: gtk_spin_button_new_with_range: assertion 'min <= max' failed

(fcitx-config-gtk3:3007633): GLib-GObject-CRITICAL **: 00:32:29.982: g_object_set: assertion 'G_IS_OBJECT (object)' failed

(fcitx-config-gtk3:3007633): GLib-GObject-WARNING **: 00:32:29.982: invalid (NULL) pointer instance

(fcitx-config-gtk3:3007633): GLib-GObject-CRITICAL **: 00:32:29.982: g_signal_connect_data: assertion 'G_TYPE_CHECK_INSTANCE (instance)' failed
Fcitx is running correctly.
```

## 解决记录

### 1. 从官网下载`fcitx-configtool`源码进行编译

#### 报错
```log
-- Checking for module 'fcitx-gclient>=4.2.9'
--   No package 'fcitx-gclient' found
CMake Error at /usr/share/cmake-3.18/Modules/FindPkgConfig.cmake:545 (message):
  A required package was not found
Call Stack (most recent call first):
  /usr/share/cmake-3.18/Modules/FindPkgConfig.cmake:733 (_pkg_check_modules_internal)
  CMakeLists.txt:16 (pkg_check_modules)
```

#### 将出错行注释掉后
```log
-- Checking for module 'gtk+-3.0>=3.20'
--   No package 'gtk+-3.0' found
CMake Error at /usr/share/cmake-3.18/Modules/FindPkgConfig.cmake:545 (message):
  A required package was not found
Call Stack (most recent call first):
  /usr/share/cmake-3.18/Modules/FindPkgConfig.cmake:733 (_pkg_check_modules_internal)
  CMakeLists.txt:17 (pkg_check_modules)
```

#### 安装下列包解决`gtk+-3.0`的问题。[参考](https://askubuntu.com/questions/779065/pkg-config-not-finding-gtk-3-0)
```shell
sudo apt-get install build-essential libgtk-3-dev
```

#### 后面报错
```log
[cmake] CMake Error at CMakeLists.txt:27 (find_package):
[cmake]   By not providing "FindFcitx.cmake" in CMAKE_MODULE_PATH this project has
[cmake]   asked CMake to find a package configuration file provided by "Fcitx", but
[cmake]   CMake did not find one.
[cmake] 
[cmake]   Could not find a package configuration file provided by "Fcitx" (requested
[cmake]   version 4.2.8) with any of the following names:
[cmake] 
[cmake]     FcitxConfig.cmake
[cmake]     fcitx-config.cmake
[cmake] 
[cmake]   Add the installation prefix of "Fcitx" to CMAKE_PREFIX_PATH or set
[cmake]   "Fcitx_DIR" to a directory containing one of the above files.  If "Fcitx"
[cmake]   provides a separate development package or SDK, be sure it has been
[cmake]   installed.
```

#### 安装下列包解决`libfcitx-qt5-dev`的问题。这同时解决了[No package 'fcitx-gclient' found](#报错)的问题
```shell
sudo apt-get install libfcitx-qt5-dev
```

#### 在`gtk3/main.c`里的第121行
修改`FcitxLogSetLevel(FCITX_NONE);`为`FcitxLogSetLevel(FCITX_DEBUG);`


### 2. 安装`fcitx5`

卸载
```
sudo apt remove fcitx*
```

卸载了以下内容
```
fcitx fcitx-bin fcitx-config-common fcitx-config-gtk fcitx-data fcitx-frontend-gtk2 fcitx-frontend-gtk3
  fcitx-frontend-qt4 fcitx-frontend-qt5 fcitx-implugin fcitx-libs-dev fcitx-module-dbus
  fcitx-module-kimpanel fcitx-module-lua fcitx-module-x11 fcitx-modules fcitx-pinyin fcitx-sunpinyin
  fcitx-table fcitx-table-wubi fcitx-ui-classic
```

安装
```
sudo apt install fcitx5 fcitx5-table
```

重启电脑